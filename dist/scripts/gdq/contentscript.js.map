{"version":3,"sources":["scripts/gdq/contentscript.js"],"names":["updateUI","msg","runners_paragraph","innerHTML","generateFormattedRunnerString","runner","game_link_a","href","link","onclick","window","open","this","category","game","updateCalendarUI","console","log","$","empty","scheduleString","_","each","order","gameTitle","index","generateScheduleItemString","schedule","highlights","html","runners","runners_keys","keys","runner_string","length","last_runner","pop","second_runner","runner_key","generateRunnerElement","runnerObject","scheduleItemObject","highlightsObject","runnerString","titleString","title","highlightStyle","scheduleItemString","estimate","calculateRefreshRate","minutes","milliseconds","updateRefreshRate","newRate","notify","icon","message","element","position","type","allow_dismiss","newest_on_top","showProgressbar","z_index","placement","from","align","parseInt","clearInterval","refreshTimer","setInterval","requestDataFromBackground","sendUpdateCalendarItemsNumber","newCalendarItemsNumber","port","postMessage","calendarItemsNumber","refreshRate","chrome","runtime","connect","name","page_elem","document","querySelector","createElement","id","className","get","extension","getURL","data","parseHTML","appendTo","menu_ul","on","e","stopPropagation","ready","updateQuakeChat","removeClass","addClass","twitchStream","after","remove","updateTwitchChat","css","append","preventDefault","updateRefreshTimerValue","serializeArray","updateScheduleItemsValue","click","that","setTimeout","bootstrapSwitch","event","state","before","onMessage","addListener","status","calendar"],"mappings":"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","file":"contentscript.js","sourcesContent":["'use strict';\n\n// Timer Variables\n\nvar refreshTimer = null;\nvar refreshRate = 300000;\n\nvar port = chrome.runtime.connect({ name: \"gdq\" });\n\nvar page_elem = document.querySelector('body');\nconsole.log(page_elem);\n\nvar runners_paragraph = document.createElement('p');\nvar game_link_a = document.createElement('a');\n\nrunners_paragraph.id = \"gdq-runners-information\";\ngame_link_a.id = \"gdq-speedrun-link\";\ngame_link_a.className = \"speedrun-link\";\n\n$.get(chrome.extension.getURL('/html/gdq-footer.html'), function (data) {\n    $($.parseHTML(data)).appendTo(page_elem);\n});\n\n$.get(chrome.extension.getURL('/html/settings-menu.html'), function (data) {\n    var menu_ul = $(\".settings-menu\");\n    $($.parseHTML(data)).appendTo(menu_ul);\n});\n\n$(page_elem).on('click', 'ul.dropdown-menu', function (e) {\n    e.stopPropagation();\n});\n\n$(document).ready(function () {\n    $(page_elem).css('margin-bottom', '70px');\n    $('#stream').html('<iframe src=\"https://player.twitch.tv/?channel=gamesdonequick\" width=\"100%\" height=\"100%\" frameborder=\"0\" scrolling=\"no\" allowFullscreen=\"true\" class=\"center-block\"></iframe>');\n    $('#stream').css('margin-top', '24px');\n    $('.game-information').append(game_link_a);\n    $('.game-information').append(runners_paragraph);\n\n    $(\"#refresh-timer-update\").on('submit', function (e) {\n        e.preventDefault();\n\n        var updateRefreshTimerValue = $('#refresh-timer-update').serializeArray()[0][\"value\"];\n\n        updateRefreshRate(updateRefreshTimerValue);\n\n        return false;\n    });\n\n    $(\"#schedule-items-update\").on('submit', function (e) {\n        e.preventDefault();\n\n        var updateScheduleItemsValue = $('#schedule-items-update').serializeArray()[0][\"value\"];\n\n        console.log(updateScheduleItemsValue);\n        sendUpdateCalendarItemsNumber(updateScheduleItemsValue);\n\n        return false;\n    });\n\n    $(\".fa.fa-refresh\").click(function () {\n        this.className = 'fa fa-refresh fa-spin';\n        console.log(\"Refreshing...\");\n        requestDataFromBackground();\n        var that = this;\n        setTimeout(function () {\n            that.className = 'fa fa-refresh';\n            console.log(\"Refresh complete.\");\n        }, 2000);\n    });\n\n    $(\".fa.fa-cog\").click(function () {\n        this.className = 'fa fa-cog fa-spin';\n        var that = this;\n        setTimeout(function () {\n            that.className = 'fa fa-cog';\n        }, 2000);\n    });\n\n    $(\"[name='quakenet-chat-switch']\").bootstrapSwitch();\n    $(\"[name='twitch-chat-switch']\").bootstrapSwitch();\n    $(\"[name='theater-mode']\").bootstrapSwitch();\n\n    /*\n        QUAKENET IRC THEATER MODE BUTTON\n    */\n\n    $('input[name=\"theater-mode\"]').on('switchChange.bootstrapSwitch', function (event, state) {\n        if ($('input[name=\"quakenet-chat-switch\"]').bootstrapSwitch('state')) {\n            updateQuakeChat('remove');\n            $('input[name=\"quakenet-chat-switch\"]').bootstrapSwitch('state', false, true);\n        }\n\n        if ($('input[name=\"theater-mode\"]').bootstrapSwitch('state')) {\n            $('#stream').html('');\n            $.get(chrome.extension.getURL('/html/quakenet-theater-mode.html'), function (data) {\n                console.log(\"Adding theater mode!\");\n                console.log($.parseHTML(data));\n                $('#battlescene').before($.parseHTML(data));\n            });\n            $('#footer').addClass('theater-footer').removeClass('standard-footer');\n        } else {\n            $('#theater-mode-div').remove();\n            $('#stream').html('<iframe src=\"https://player.twitch.tv/?channel=gamesdonequick\" width=\"100%\" height=\"100%\" frameborder=\"0\" scrolling=\"no\" allowFullscreen=\"true\" class=\"center-block\"></iframe>');\n            $('#footer').addClass('standard-footer').removeClass('theater-footer');\n        }\n    });\n\n    $('input[name=\"quakenet-chat-switch\"]').on('switchChange.bootstrapSwitch', function (event, state) {\n        console.log('Clicked QUAKENET Switch.');\n        console.log(this);\n        console.log(\"Twitch State:\");\n        console.log($('input[name=\"twitch-chat-switch\"]').bootstrapSwitch('state'));\n        console.log(\"Quake State:\");\n        console.log($('input[name=\"quakenet-chat-switch\"]').bootstrapSwitch('state'));\n\n        if ($('input[name=\"twitch-chat-switch\"]').bootstrapSwitch('state')) {\n            updateTwitchChat('remove');\n            $('input[name=\"twitch-chat-switch\"]').bootstrapSwitch('state', false, true);\n            if ($('input[name=\"quakenet-chat-switch\"]').bootstrapSwitch('state')) {\n                updateQuakeChat('add');\n            } else {\n                updateQuakeChat('remove');\n            }\n        } else {\n            console.log();\n            if ($('input[name=\"quakenet-chat-switch\"]').bootstrapSwitch('state')) {\n                updateQuakeChat('add');\n            } else {\n                updateQuakeChat('remove');\n            }\n        }\n    });\n\n    $('input[name=\"twitch-chat-switch\"]').on('switchChange.bootstrapSwitch', function (event, state) {\n        console.log('Clicked Twitch Switch.');\n        if ($('input[name=\"quakenet-chat-switch\"]').bootstrapSwitch('state')) {\n            updateQuakeChat('remove');\n            $('input[name=\"quakenet-chat-switch\"]').bootstrapSwitch('state', false, true);\n            if ($('input[name=\"twitch-chat-switch\"]').bootstrapSwitch('state')) {\n                updateTwitchChat('add');\n            } else {\n                updateTwitchChat('remove');\n            }\n        } else {\n            if ($('input[name=\"twitch-chat-switch\"]').bootstrapSwitch('state')) {\n                updateTwitchChat('add');\n            } else {\n                updateTwitchChat('remove');\n            }\n        }\n    });\n\n    function updateQuakeChat(msg) {\n        if (msg == 'add') {\n            console.log('Switch is on. Adding Chat iframe and modifying UI.');\n            $('#stream').removeClass('center-block').addClass('pull-left');\n            $.get(chrome.extension.getURL('/html/quakenet-chat.html'), function (data) {\n                var twitchStream = $(\"#stream\");\n                $(twitchStream).after($.parseHTML(data));\n            });\n        } else if (msg == 'remove') {\n            console.log('Switch is off. Removing UI.');\n            $('#stream').addClass('center-block').removeClass('pull-left');\n            $('#quakenet-chat').remove();\n            $('#quakenet-clear').remove();\n        }\n    }\n\n    function updateTwitchChat(msg) {\n        if (msg == 'add') {\n            console.log('Switch is on. Adding Chat iframe and modifying UI.');\n            $('#stream').removeClass('center-block').addClass('pull-left');\n            $.get(chrome.extension.getURL('/html/twitch-chat.html'), function (data) {\n                var twitchStream = $(\"#stream\");\n                $(twitchStream).after($.parseHTML(data));\n            });\n        } else if (msg == 'remove') {\n            console.log('Switch is off. Removing UI.');\n            $('#stream').addClass('center-block').removeClass('pull-left');\n            $('#twitch-chat').remove();\n            $('#twitch-clear').remove();\n        }\n    }\n});\n\n//Port Listeners\n\nvar port = chrome.runtime.connect({ name: \"gdq\" });\nport.postMessage({ message: \"request\" });\nport.onMessage.addListener(function (msg) {\n    if (msg.status == \"changed\") {\n        console.log(msg);\n        console.log(\"The Current Game is: \" + msg.game);\n        if ($()) {\n            updateUI(msg);\n            updateCalendarUI(msg.calendar);\n        }\n    } else if (msg.status == \"unchanged\") {\n        console.log(\"Current game has not changed since last request\");\n    } else if (msg.status == \"reload\") {\n        console.log(\"Reload has occurred\");\n        console.log(msg);\n        console.log(\"The Current Game is: \" + msg.game);\n        updateUI(msg);\n        updateCalendarUI(msg.calendar);\n    }\n});\n\n/*\n  Object\n    Game\n    Runner\n    Estimate\n    Category\n    Link\n*/\n\nfunction updateUI(msg) {\n    runners_paragraph.innerHTML = generateFormattedRunnerString(msg.runner);\n    game_link_a.href = msg.link;\n    game_link_a.onclick = function () {\n        window.open(this.href);\n        return false;\n    };\n\n    if (msg.category != null) {\n        game_link_a.innerHTML = msg.game + ' (' + msg.category + ')';\n    } else {\n        game_link_a.innerHTML = msg.game;\n    }\n}\n\nfunction updateCalendarUI(msg) {\n    console.log(\"Calendar updating...\");\n    console.log(msg);\n    if (msg != null) {\n        $('#schedule-table tbody').empty();\n\n        var scheduleString = \"\";\n        _.each(msg.order, function (gameTitle, index) {\n            scheduleString += generateScheduleItemString(msg.schedule[gameTitle], msg.highlights, index + 1);\n        });\n\n        $('#schedule-table tbody').html(scheduleString);\n        console.log(\"Calendar updated.\");\n    } else {\n        return;\n    }\n}\n\nfunction generateFormattedRunnerString(runners) {\n    var runners_keys = _.keys(runners);\n    var runner_string = \"by \";\n    if (runners_keys.length > 2) {\n        var last_runner = runners_keys.pop();\n        var second_runner = runners_keys.pop();\n        $.each(runners_keys, function (index, runner_key) {\n            runner_string += generateRunnerElement(runners, runner_key) + ', ';\n        });\n\n        runner_string += generateRunnerElement(runners, second_runner) + ' ';\n        runner_string += 'and ';\n        runner_string += generateRunnerElement(runners, last_runner);\n    } else if (runners_keys.length == 2) {\n        var last_runner = runners_keys.pop();\n        var second_runner = runners_keys.pop();\n\n        runner_string += generateRunnerElement(runners, second_runner);\n        runner_string += ' and ';\n        runner_string += generateRunnerElement(runners, last_runner);\n    } else if (runners_keys.length == 1) {\n        var runner_key = runners_keys[0];\n        runner_string += generateRunnerElement(runners, runners_keys[0]);\n    } else {\n        console.log(\"Error no runners.\");\n        runner_string = \"\";\n    }\n    return runner_string;\n}\n\nfunction generateRunnerElement(runnerObject, runner_key) {\n    if (runnerObject[runner_key][\"logo\"] == null) {\n        return '<a href=\"https://' + runnerObject[runner_key][\"link\"] + '\" onclick=\"window.open(this.href); return false;\">' + runner_key + '</a>';\n    } else {\n        return '<a href=\"https://' + runnerObject[runner_key][\"link\"] + '\" onclick=\"window.open(this.href); return false;\"><img class=\"runner-logo\" src=\"' + runnerObject[runner_key][\"logo\"] + '\" />' + runner_key + '</a>';\n    }\n}\n\nfunction generateScheduleItemString(scheduleItemObject, highlightsObject, index) {\n    var runnerString = generateFormattedRunnerString(scheduleItemObject.runner);\n    if (scheduleItemObject.category != null) {\n        var titleString = scheduleItemObject.title + ' (' + scheduleItemObject.category + ')';\n    } else {\n        var titleString = scheduleItemObject.title;\n    }\n\n    console.log(highlightsObject);\n\n    if (typeof highlightsObject[scheduleItemObject.title] == 'undefined' || highlightsObject[scheduleItemObject.title] == false) {\n        var highlightStyle = '';\n    } else {\n        var highlightStyle = 'background-color:#555555;';\n        titleString = '<i class=\"fa fa-star\"></i> ' + titleString;\n    }\n\n    var scheduleItemString = '<tr style=' + highlightStyle + '>\\n                                <th scope=\"row\">' + index + '</th>\\n                                <td>\\n                                    <a class=\"speedrun-link\" id=\"next-game-title\" href=\"' + scheduleItemObject.link + '\" onclick=\"window.open(this.href); return false;\"> ' + titleString + '</a>\\n                                    <p class=\"runners-links\" id=\"next-runners-information\">' + runnerString + '</p>\\n                                </td>\\n                                <td style=\"width: 114px;\">\\n                                    <p class=\"text-right\"><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ' + scheduleItemObject.estimate + '</p>\\n                                </td>\\n                              </tr>';\n\n    return scheduleItemString;\n}\n\nfunction calculateRefreshRate(minutes) {\n    // body...\n    var milliseconds = minutes * 60000;\n\n    return milliseconds;\n}\n\nfunction updateRefreshRate(newRate) {\n    if (newRate == \"Set Refresh Timer:\") {\n        console.log(\"No change in refresh timer value.\");\n\n        $.notify({\n            icon: 'glyphicon glyphicon-warning-sign',\n            title: 'Refresh Timer Update:',\n            message: 'Please choose an option from the menu!'\n        }, {\n            // settings\n            element: 'body',\n            position: null,\n            type: \"danger\",\n            allow_dismiss: true,\n            newest_on_top: true,\n            showProgressbar: false,\n            z_index: 10001,\n            placement: {\n                from: \"top\",\n                align: \"right\"\n            }\n        });\n\n        return;\n    } else if (typeof parseInt(newRate) == \"number\" && parseInt(newRate) > 0) {\n        clearInterval(refreshTimer);\n        var milliseconds = calculateRefreshRate(parseInt(newRate));\n        setInterval(requestDataFromBackground, milliseconds);\n        console.log(\"Refresh Timer has been updated to: \" + newRate + \" minutes or \" + milliseconds + \" milliseconds\");\n\n        $.notify({\n            icon: 'glyphicon glyphicon-time',\n            title: 'Refresh Timer Update:',\n            message: 'Updated to refresh every ' + newRate + ' minutes'\n        }, {\n            // settings\n            element: 'body',\n            position: null,\n            type: \"success\",\n            allow_dismiss: true,\n            newest_on_top: true,\n            showProgressbar: false,\n            z_index: 10001,\n            placement: {\n                from: \"top\",\n                align: \"right\"\n            }\n        });\n    }\n}\n\nfunction sendUpdateCalendarItemsNumber(newCalendarItemsNumber) {\n    if (newCalendarItemsNumber == \"Set # of Runs to Display:\") {\n        console.log(\"No change in numbers of runs to display in schedule.\");\n\n        $.notify({\n            icon: 'glyphicon glyphicon-warning-sign',\n            title: 'Schedule Items Update',\n            message: 'Please choose an option from the menu!'\n        }, {\n            // settings\n            element: 'body',\n            position: null,\n            type: \"danger\",\n            allow_dismiss: true,\n            newest_on_top: true,\n            showProgressbar: false,\n            z_index: 10001,\n            placement: {\n                from: \"top\",\n                align: \"right\"\n            }\n        });\n\n        return;\n    } else if (typeof parseInt(newCalendarItemsNumber) == \"number\" && parseInt(newCalendarItemsNumber) > 0) {\n        port.postMessage({ message: \"schedule\", calendarItemsNumber: parseInt(newCalendarItemsNumber) });\n\n        $.notify({\n            icon: 'glyphicon glyphicon-time',\n            title: 'Schedule Items Update:',\n            message: 'Updated to display ' + newCalendarItemsNumber + ' runs.'\n        }, {\n            // settings\n            element: 'body',\n            position: null,\n            type: \"success\",\n            allow_dismiss: true,\n            newest_on_top: true,\n            showProgressbar: false,\n            z_index: 10001,\n            placement: {\n                from: \"top\",\n                align: \"right\"\n            }\n        });\n    }\n}\n\nfunction requestDataFromBackground() {\n    port.postMessage({ message: \"request\" });\n}\nrefreshTimer = setInterval(requestDataFromBackground, refreshRate);"]}