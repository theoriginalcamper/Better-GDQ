!function(e){var n={};function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)r.d(t,a,function(n){return e[n]}.bind(null,a));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=0)}([function(e,n,r){"use strict";function t(e){console.log(e);var n=e.split(", ");return _.reduce(n,function(e,n){var r=runnerJSON[n];if(void 0!==r)return e[n]={logo:r.logo,link:r.link},e;$.getJSON("https://gist.githubusercontent.com/theoriginalcamper/250f581aec12ecd9a6510feeb9216b2a/raw/sgdq2019_runners.json").done(function(t){if(_.difference(_.keys(t),_.keys(runnerJSON))!=[])return gdqRunnerJSON=t,runnerJSON=gdqRunnerJSON,r=runnerJSON[n],e[n]={logo:r.logo,link:r.link},e;checkForUpdatedRunnerJSON=setInterval(function(){$.getJSON("https://gist.githubusercontent.com/theoriginalcamper/250f581aec12ecd9a6510feeb9216b2a/raw/sgdq2019_runners.json").done(function(e){_.difference(_.keys(e),_.keys(runnerJSON))!=[]&&(gdqRunnerJSON=e,runnerJSON=gdqRunnerJSON,clearInterval(checkForUpdatedRunnerJSON),getSpeedrunData(current_game,portForMessage))})},6e4)})},{})}window.current_game=null,window.current_game_title=null,window.current_link=null,window.current_runners=null,window.current_estimate=null,window.current_category=null,window.current_calendar=null,window.current_number_calendar_items=4,window.runnerJSON=null,window.scheduleJSON=null,window.fuzzySet=null,window.highlightsTitle=null,window.gdqRunnerJSON=null,window.gdqScheduleJSON=null,window.gdqFuzzySet=null,window.gdqFuzzySearchArray=null,window.gdqHighlightsTitle="scheduleHighlights",window.esaRunnerJSON=null,window.esaScheduleJSON=null,window.esaFuzzySet=null,window.esaFuzzySearchArray=null,window.esaHighlightsTitle="esa16scheduleHighlights",window.checkForUpdatedScheduleJSON=null,window.portForMessage=null,$.getJSON("/json/sgdq2019_runners.json").done(function(e){gdqRunnerJSON=e}),$.getJSON("/json/sgdq2019_schedule.json").done(function(e){gdqScheduleJSON=e,gdqFuzzySearchArray=_.keys(gdqScheduleJSON),gdqFuzzySet=FuzzySet(gdqFuzzySearchArray),console.log(gdqFuzzySet)}),$.getJSON("/json/esa_runners.json").done(function(e){esaRunnerJSON=e}),$.getJSON("/json/esa_schedule.json").done(function(e){esaScheduleJSON=e,esaFuzzySearchArray=_.keys(esaScheduleJSON),esaFuzzySet=FuzzySet(esaFuzzySearchArray),console.log(esaFuzzySet)}),chrome.runtime.onConnect.addListener(function(e){portForMessage=e,"gdq"==e.name?(console.assert("gdq"==e.name),e.onMessage.addListener(function(n){console.log(n),"request"==n.message?$.ajax({datatype:"json",url:"https://api.twitch.tv/channels/gamesdonequick",beforeSend:function(e){e.setRequestHeader("Client-ID","b7r2pt8m5gawx9u2ur2d9rx26xo6h7w")},success:function(n){console.log("Completed request to Twitch"),current_game!=n.game?(console.log("The Current Game being run is: "+n.game),current_game=n.game,getSpeedrunData(current_game,e),console.log(current_link)):console.log("Still the same")}}):"schedule"==n.message?(console.log(n.calendarItemsNumber),current_number_calendar_items=n.calendarItemsNumber,getSpeedrunData(current_game,e)):"refresh"==n.message&&$.ajax({datatype:"json",url:"https://api.twitch.tv/channels/gamesdonequick",beforeSend:function(e){e.setRequestHeader("Client-ID","b7r2pt8m5gawx9u2ur2d9rx26xo6h7w")},success:function(n){console.log("Completed request to Twitch"),current_game!=n.game?(console.log("The Current Game being run is: "+n.game),current_game=n.game,getSpeedrunData(current_game,e),console.log(current_link)):(console.log("Still the same"),getSpeedrunData(current_game,e))}})})):"esa"==e.name&&(console.assert("esa"==e.name),e.onMessage.addListener(function(n){"request"==n.message?$.getJSON("https://api.twitch.tv/channels/esamarathon").done(function(n){console.log("Completed request to Twitch"),current_game!=n.game?(console.log("The Current Game being run is: "+n.game),current_game=n.game,getSpeedrunData(current_game,e),console.log(current_link)):console.log("Still the same")}):"schedule"==n.message?(console.log(n.calendarItemsNumber),current_number_calendar_items=n.calendarItemsNumber,getSpeedrunData(current_game,e,esaScheduleJSON,esaRunnerJSON,esaHighlightsTitle,esaFuzzySet)):"refresh"==n.message&&$.getJSON("https://api.twitch.tv/channels/esamarathon").done(function(n){console.log("Completed request to Twitch"),current_game!=n.game?(console.log("The Current Game being run is: "+n.game),current_game=n.game,getSpeedrunData(current_game,e),console.log(current_link)):(console.log("Still the same"),getSpeedrunData(current_game,e))})}))}),window.getSpeedrunData=function(e,n){console.log(n.name),"gdq"==n.name?(console.assert("gdq"==n.name),scheduleJSON=gdqScheduleJSON,runnerJSON=gdqRunnerJSON,highlightsTitle=gdqHighlightsTitle,fuzzySet=gdqFuzzySet):"esa"==n.name&&(console.assert("esa"==n.name),scheduleJSON=esaScheduleJSON,runnerJSON=esaRunnerJSON,highlightsTitle=esaHighlightsTitle,fuzzySet=esaFuzzySet);var r=scheduleJSON[e];if(void 0===r&&("gdq"==n.name?$.getJSON("https://gist.githubusercontent.com/theoriginalcamper/99cf3867bf38cd66b52d95640a6689a0/raw/sgdq2019_schedule.json").done(function(n){console.log("Request for Schedule JSON sent"),_.difference(_.keys(n),_.keys(scheduleJSON))==[]?(console.log("JSON is not updated"),checkForUpdatedScheduleJSON=setInterval(function(){$.getJSON("https://gist.githubusercontent.com/theoriginalcamper/99cf3867bf38cd66b52d95640a6689a0/raw/sgdq2019_schedule.json").done(function(e){_.difference(_.keys(e),_.keys(scheduleJSON))!=[]&&(gdqScheduleJSON=e,scheduleJSON=gdqScheduleJSON,clearInterval(checkForUpdatedScheduleJSON),getSpeedrunData(current_game,portForMessage))})},6e4)):(console.log("JSON has been updated. Using new version!"),gdqScheduleJSON=n,scheduleJSON=gdqScheduleJSON,r=scheduleJSON[e])}):"esa"==n.name&&$.getJSON("https://gist.githubusercontent.com/theoriginalcamper/cde736fb9e43b34cf8f49c0c82d7c564/raw/esa_schedule2016.json").done(function(n){console.log("Request for Schedule JSON sent"),_.difference(_.keys(n),_.keys(scheduleJSON))==[]?(console.log("JSON is not updated"),checkForUpdatedScheduleJSON=setInterval(function(){$.getJSON("https://gist.githubusercontent.com/theoriginalcamper/cde736fb9e43b34cf8f49c0c82d7c564/raw/esa_schedule2016.json").done(function(e){_.difference(_.keys(e),_.keys(scheduleJSON))!=[]&&(esaScheduleJSON=e,scheduleJSON=esaScheduleJSON,clearInterval(checkForUpdatedScheduleJSON),getSpeedrunData(current_game,portForMessage))})},6e4)):(console.log("JSON has been updated. Using new version!"),esaScheduleJSON=n,scheduleJSON=esaScheduleJSON,r=scheduleJSON[e])})),void 0!==r){clearInterval(checkForUpdatedScheduleJSON),"undefined"!=typeof possibleGameTitle?current_game=possibleGameTitle[0][1]:current_game=e,current_game_title=r.title,current_runners=t(r.runner),current_estimate=r.estimate,current_category=r.category,current_link=r.link;var a=[],s=_.keys(scheduleJSON).indexOf(current_game);console.log(s);var o=null;current_calendar={};_.keys(scheduleJSON).length-(s+1)>=current_number_calendar_items?_(current_number_calendar_items).times(function(e){o=_.keys(scheduleJSON)[s+e+1],a.push(o)}):_(_.keys(scheduleJSON).length-(s+1)).times(function(e){o=_.keys(scheduleJSON)[s+e+1],a.push(o)}),console.log(a);var u=_.reduce(a,function(e,n){return e[n]=$.extend({},scheduleJSON[n]),e[n].runner=t($.extend({},scheduleJSON[n]).runner),e},{});chrome.storage.sync.get(highlightsTitle,function(e){current_calendar.order=a,current_calendar.schedule=u,_.isEmpty(e)?current_calendar.highlights={}:current_calendar.highlights=e[highlightsTitle],console.log(current_calendar),console.log("Game Data for "+current_game_title+" has been retrieved."),n.postMessage({status:"changed",game:current_game_title,runner:current_runners,estimate:current_estimate,category:current_category,link:current_link,calendar:current_calendar}),console.log("Game Data sent!")})}else console.log("Fuzzy text search failed to find a game title above the required threshold.")},chrome.tabs.onUpdated.addListener(function(e,n,r){r.url.indexOf("https://gamesdonequick.com")>-1&&void 0===n.url&&null!=portForMessage&&portForMessage.postMessage({status:"reload",game:current_game_title,runner:current_runners,estimate:current_estimate,category:current_category,link:current_link,calendar:current_calendar})}),chrome.tabs.onUpdated.addListener(function(e,n,r){r.url.indexOf("http://gamesdonequick.com")>-1&&void 0===n.url&&null!=portForMessage&&portForMessage.postMessage({status:"reload",game:current_game_title,runner:current_runners,estimate:current_estimate,category:current_category,link:current_link,calendar:current_calendar})}),chrome.tabs.onUpdated.addListener(function(e,n,r){r.url.indexOf("https://discordapp.com/channels/140605087511740416/140605087511740416")>-1&&void 0===n.url&&(current_game_title!=current_game?getSpeedrunData(current_game,portForMessage):portForMessage.postMessage({status:"reload",game:current_game_title,runner:current_runners,estimate:current_estimate,category:current_category,link:current_link,calendar:current_calendar}))}),chrome.tabs.onUpdated.addListener(function(e,n,r){r.url.indexOf("https://www.esamarathon.com")>-1&&void 0===n.url&&"esa"==portForMessage.name&&(current_game_title!=current_game?getSpeedrunData(current_game,portForMessage):portForMessage.postMessage({status:"reload",game:current_game_title,runner:current_runners,estimate:current_estimate,category:current_category,link:current_link,calendar:current_calendar}))}),chrome.tabs.onUpdated.addListener(function(e,n,r){r.url.indexOf("http://www.esamarathon.com")>-1&&void 0===n.url&&"esa"==portForMessage.name&&(current_game_title!=current_game?getSpeedrunData(current_game,portForMessage):portForMessage.postMessage({status:"reload",game:current_game_title,runner:current_runners,estimate:current_estimate,category:current_category,link:current_link,calendar:current_calendar}))}),chrome.storage.onChanged.addListener(function(e,n){console.log(e),portForMessage.postMessage({status:"version",changes:e})})}]);
//# sourceMappingURL=background.js.map